<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h4><i class="fas fa-flask"></i> Teste de Integração - Fase 1</h4>
      <p class="mb-0">Verificando conexão entre Frontend e Backend</p>
    </div>
    <div class="card-body">
      <div class="row mb-3">
        <div class="col-md-6">
          <button class="btn btn-primary me-2" (click)="runTests()" [disabled]="loading">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            {{ loading ? 'Testando...' : 'Executar Todos os Testes' }}
          </button>
          <button class="btn btn-info me-2" (click)="testLogin()">
            Testar Login
          </button>
          <button class="btn btn-warning me-2" (click)="logout()">
            Logout
          </button>
        </div>
        <div class="col-md-6">
          <button class="btn btn-success me-2" (click)="testInterceptors()">
            Testar Interceptors
          </button>
          <button class="btn btn-secondary" (click)="testSweetAlert()">
            Testar SweetAlert2
          </button>
        </div>
      </div>

      <div class="table-responsive">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Teste</th>
              <th>Status</th>
              <th>Detalhes</th>
              <th>Horário</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let result of testResults" 
                [class]="'table-' + (result.status === 'Sucesso' ? 'success' : 
                                   result.status === 'Erro' ? 'danger' : 
                                   result.status === 'Autenticado' ? 'info' : 'warning')">
              <td>{{ result.test }}</td>
              <td>
                <span class="badge" 
                      [class]="'bg-' + (result.status === 'Sucesso' ? 'success' : 
                                       result.status === 'Erro' ? 'danger' : 
                                       result.status === 'Autenticado' ? 'info' : 'warning')">
                  {{ result.status }}
                </span>
              </td>
              <td>{{ result.details }}</td>
              <td>{{ result.timestamp }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="alert alert-info mt-3">
        <h5><i class="fas fa-info-circle"></i> Como testar:</h5>
        <ol>
          <li>Certifique-se de que o backend está rodando na porta 7116</li>
          <li>Execute "Executar Todos os Testes" para verificar conexões básicas</li>
          <li>Use "Testar Login" com as credenciais do seu banco de dados</li>
          <li>Verifique se não há erros de CORS no console do navegador</li>
        </ol>
      </div>

      <div class="alert alert-success mt-3">
        <h5><i class="fas fa-check-circle"></i> Interceptors Padrão Vedrano Implementados:</h5>
        <ul class="mb-0">
          <li>✅ <strong>ErrorHandlerService</strong> - Intercepta erros e mostra SweetAlert2</li>
          <li>✅ <strong>LoadingInterceptor</strong> - Mostra spinner durante requisições</li>
          <li>✅ <strong>TokenInterceptorService</strong> - Adiciona JWT automaticamente</li>
          <li>✅ <strong>SweetAlert2</strong> - Alertas modernos e responsivos</li>
          <li>✅ <strong>LoadingService</strong> - Controle global de loading</li>
          <li>✅ <strong>Página 404</strong> - Tratamento de rotas inexistentes</li>
        </ul>
      </div>
    </div>
  </div>
</div> 